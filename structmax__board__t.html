<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.11.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>max: max_board_t Struct Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">max
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.11.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('structmax__board__t.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-attribs">Data Fields</a>  </div>
  <div class="headertitle"><div class="title">max_board_t Struct Reference<div class="ingroups"><a class="el" href="group__board.html">Chessboard</a></div></div></div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="board_8h_source.html">board.h</a>&gt;</code></p>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Chessboard representation based on the architecture proposed in 'New Architectures in Computer Chess' [1] by Fritz Reul. </p>
<p>The structure mainly consists of two data structures that must be kept in sync over the course of move making and unmaking, the piece code by square array and board position-by-type lists maintained for each side. The additional memory and complexity costs of the redundant structures are heavily outweighed by the gains in efficiency during evaluation and move generation.</p>
<h1><a class="anchor" id="irrev"></a>
Irreversible State</h1>
<p>In addition to the piece bookkeeping, we also track certain irreversible state of the game - castle rights, en passant availability, captures made, and the last two positions reached to determine draws by threefold repetition.</p>
<p>Two data structures are responsible for the bookkeeping required to make and unmake moves that change the state irreversibly. The capture stack stores the type and color code of each captured piece, enabling capture moves to be unmade by popping from the stack. In addition to this, a second stack maintains irreversible state computed for each ply - castle rights, en passant validity, check attack data, and a unique zobrist hash of the position.</p>
<p>[1] <a href="https://pure.uvt.nl/ws/files/1098572/Proefschrift_Fritz_Reul_170609.pdf">https://pure.uvt.nl/ws/files/1098572/Proefschrift_Fritz_Reul_170609.pdf</a> </p>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-attribs" name="pub-attribs"></a>
Data Fields</h2></td></tr>
<tr class="memitem:aa755e75340af38326b088d84c259d955" id="r_aa755e75340af38326b088d84c259d955"><td class="memItemLeft" align="right" valign="top"><a id="aa755e75340af38326b088d84c259d955" name="aa755e75340af38326b088d84c259d955"></a>
<a class="el" href="structmax__zobrist__elements__t.html">max_zobrist_elements_t</a>&#160;</td><td class="memItemRight" valign="bottom"><b>zobrist_state</b></td></tr>
<tr class="memdesc:aa755e75340af38326b088d84c259d955"><td class="mdescLeft">&#160;</td><td class="mdescRight">Statically initialized arrays used to iteratively compute zobrist hash keys. <br /></td></tr>
<tr class="separator:aa755e75340af38326b088d84c259d955"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a794fea3f17fe6f647bb3357de9d6989f" id="r_a794fea3f17fe6f647bb3357de9d6989f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structmax__piececode__t.html">max_piececode_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a794fea3f17fe6f647bb3357de9d6989f">pieces</a> [<a class="el" href="group__loc.html#ga91f4d7b06655d6cd3696bdcf193c9c8a">MAX_0x88_LEN</a>]</td></tr>
<tr class="memdesc:a794fea3f17fe6f647bb3357de9d6989f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Piece type and color data array indexed by a packed board location <a class="el" href="structmax__0x88__t.html" title="A board rank and file location packed into a single byte using the 0x88 encoding scheme.">max_0x88_t</a>.  <br /></td></tr>
<tr class="separator:a794fea3f17fe6f647bb3357de9d6989f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac78daaf0745d55cc4022aac2e5e81411" id="r_ac78daaf0745d55cc4022aac2e5e81411"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__piecelist.html#ga724d4284337ffee4b6e281501939083b">max_lidx_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac78daaf0745d55cc4022aac2e5e81411">indices</a> [<a class="el" href="group__loc.html#ga91f4d7b06655d6cd3696bdcf193c9c8a">MAX_0x88_LEN</a>]</td></tr>
<tr class="memdesc:ac78daaf0745d55cc4022aac2e5e81411"><td class="mdescLeft">&#160;</td><td class="mdescRight">A reverse map storing the list index of the piece on each square indexed by a 0x88 board location.  <br /></td></tr>
<tr class="separator:ac78daaf0745d55cc4022aac2e5e81411"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abbd9b6131690ff8257607a6d9ffcaf14" id="r_abbd9b6131690ff8257607a6d9ffcaf14"><td class="memItemLeft" >union {&#160;</td><td class="memItemRight" valign="bottom"></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a71b2c1c6e9d540311639d738274d48df" id="r_a71b2c1c6e9d540311639d738274d48df"><td class="memItemLeft" >
&#160;&#160;&#160;struct {&#160;</td><td class="memItemRight" valign="bottom"></td></tr>
<tr class="separator:a5b14789a43208b4038a5d560685a2454"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8c154909970a93f3fd118b370b3a627" id="r_aa8c154909970a93f3fd118b370b3a627"><td class="memItemLeft" >
&#160;&#160;&#160;&#160;&#160;&#160;<a class="el" href="structmax__pieces__t.html">max_pieces_t</a>&#160;&#160;&#160;<b>white</b>&#160;</td><td class="memItemRight" valign="bottom"></td></tr>
<tr class="separator:aa8c154909970a93f3fd118b370b3a627"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a95c71916685aa6e7cbe87afb521ab63e" id="r_a95c71916685aa6e7cbe87afb521ab63e"><td class="memItemLeft" >
&#160;&#160;&#160;&#160;&#160;&#160;<a class="el" href="structmax__pieces__t.html">max_pieces_t</a>&#160;&#160;&#160;<b>black</b>&#160;</td><td class="memItemRight" valign="bottom"></td></tr>
<tr class="separator:a95c71916685aa6e7cbe87afb521ab63e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a71b2c1c6e9d540311639d738274d48df" id="r_a71b2c1c6e9d540311639d738274d48df"><td class="memItemLeft" valign="top">&#160;&#160;&#160;}&#160;&#160;&#160;<b>side</b>&#160;</td><td class="memItemRight" valign="bottom"></td></tr>
<tr class="separator:a71b2c1c6e9d540311639d738274d48df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab336d3bf8c7613c2bbb9df678198ff47" id="r_ab336d3bf8c7613c2bbb9df678198ff47"><td class="memItemLeft" >
&#160;&#160;&#160;<a class="el" href="structmax__pieces__t.html">max_pieces_t</a>&#160;&#160;&#160;<b>lists</b> [2]&#160;</td><td class="memItemRight" valign="bottom"></td></tr>
<tr class="separator:ab336d3bf8c7613c2bbb9df678198ff47"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abbd9b6131690ff8257607a6d9ffcaf14" id="r_abbd9b6131690ff8257607a6d9ffcaf14"><td class="memItemLeft" valign="top">};&#160;</td><td class="memItemRight" valign="bottom">&#160;</td><td class="memItemRight" valign="bottom"></td></tr>
<tr class="memdesc:abbd9b6131690ff8257607a6d9ffcaf14"><td class="mdescLeft">&#160;</td><td class="mdescRight">Piece lists for white and black tracking the positions of every piece on the board. <br /></td></tr>
<tr class="separator:abbd9b6131690ff8257607a6d9ffcaf14"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a759758da5eee51a93b5271f26b4124d8" id="r_a759758da5eee51a93b5271f26b4124d8"><td class="memItemLeft" align="right" valign="top"><a id="a759758da5eee51a93b5271f26b4124d8" name="a759758da5eee51a93b5271f26b4124d8"></a>
<a class="el" href="structmax__captures__t.html">max_captures_t</a>&#160;</td><td class="memItemRight" valign="bottom"><b>captures</b></td></tr>
<tr class="memdesc:a759758da5eee51a93b5271f26b4124d8"><td class="mdescLeft">&#160;</td><td class="mdescRight">A stack of all captures made over the course of the game, enabling move unmaking for capture moves. <br /></td></tr>
<tr class="separator:a759758da5eee51a93b5271f26b4124d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c8cbd0e16cd4340474616cf33a415b9" id="r_a5c8cbd0e16cd4340474616cf33a415b9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structmax__state__stack__t.html">max_state_stack_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5c8cbd0e16cd4340474616cf33a415b9">stack</a></td></tr>
<tr class="memdesc:a5c8cbd0e16cd4340474616cf33a415b9"><td class="mdescLeft">&#160;</td><td class="mdescRight">The variable-size stack of game states used to make and unmake moves - <em>and</em> to determine draws by threefold repetition.  <br /></td></tr>
<tr class="separator:a5c8cbd0e16cd4340474616cf33a415b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af04c31132747cfb5574d7b9460f1d6d0" id="r_af04c31132747cfb5574d7b9460f1d6d0"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af04c31132747cfb5574d7b9460f1d6d0">ply</a></td></tr>
<tr class="memdesc:af04c31132747cfb5574d7b9460f1d6d0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Counter of the number of plies (halfmoves) that have been played so far.  <br /></td></tr>
<tr class="separator:af04c31132747cfb5574d7b9460f1d6d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Field Documentation</h2>
<a id="abbd9b6131690ff8257607a6d9ffcaf14" name="abbd9b6131690ff8257607a6d9ffcaf14"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abbd9b6131690ff8257607a6d9ffcaf14">&#9670;&#160;</a></span>[union]</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">union  { ... }  <a class="el" href="structmax__board__t.html">max_board_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Piece lists for white and black tracking the positions of every piece on the board. </p>
<p>Stored as a union between a two-element array and a structure to allow access by side name and efficient indexing by a <a class="el" href="group__board.html#ga9fba99507b775c66bb74b7d2ba2d5369" title="Simple typedef over a single byte for an index used to identify one of the players.">max_side_t</a> </p>

</div>
</div>
<a id="ac78daaf0745d55cc4022aac2e5e81411" name="ac78daaf0745d55cc4022aac2e5e81411"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac78daaf0745d55cc4022aac2e5e81411">&#9670;&#160;</a></span>indices</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__piecelist.html#ga724d4284337ffee4b6e281501939083b">max_lidx_t</a> max_board_t::indices[<a class="el" href="group__loc.html#ga91f4d7b06655d6cd3696bdcf193c9c8a">MAX_0x88_LEN</a>]</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>A reverse map storing the list index of the piece on each square indexed by a 0x88 board location. </p>
<p>These indices map into either the white or black piece lists depending on the color and type of the piececode in <a class="el" href="#a794fea3f17fe6f647bb3357de9d6989f" title="Piece type and color data array indexed by a packed board location max_0x88_t.">pieces</a> located at the same square. This structure must be kept in sync with the <a class="el" href="#a794fea3f17fe6f647bb3357de9d6989f" title="Piece type and color data array indexed by a packed board location max_0x88_t.">pieces</a> array and the respective piece lists for each side. </p>

</div>
</div>
<a id="a794fea3f17fe6f647bb3357de9d6989f" name="a794fea3f17fe6f647bb3357de9d6989f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a794fea3f17fe6f647bb3357de9d6989f">&#9670;&#160;</a></span>pieces</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structmax__piececode__t.html">max_piececode_t</a> max_board_t::pieces[<a class="el" href="group__loc.html#ga91f4d7b06655d6cd3696bdcf193c9c8a">MAX_0x88_LEN</a>]</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Piece type and color data array indexed by a packed board location <a class="el" href="structmax__0x88__t.html" title="A board rank and file location packed into a single byte using the 0x88 encoding scheme.">max_0x88_t</a>. </p>
<p>This array is the most commonly accessed during most operations, as it allows us to find a piece by location. The locations of each piece on this board must be kept in sync with the side piece lists during all operations on the board. </p>

</div>
</div>
<a id="af04c31132747cfb5574d7b9460f1d6d0" name="af04c31132747cfb5574d7b9460f1d6d0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af04c31132747cfb5574d7b9460f1d6d0">&#9670;&#160;</a></span>ply</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t max_board_t::ply</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Counter of the number of plies (halfmoves) that have been played so far. </p>
<p>This counter is also used to derive the current <a class="el" href="group__board.html#ga9fba99507b775c66bb74b7d2ba2d5369" title="Simple typedef over a single byte for an index used to identify one of the players.">max_side_t</a> index by bitwise ANDing with 1 (e.g. an odd ply means black is to move on that ply) </p>

</div>
</div>
<a id="a5c8cbd0e16cd4340474616cf33a415b9" name="a5c8cbd0e16cd4340474616cf33a415b9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5c8cbd0e16cd4340474616cf33a415b9">&#9670;&#160;</a></span>stack</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structmax__state__stack__t.html">max_state_stack_t</a> max_board_t::stack</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The variable-size stack of game states used to make and unmake moves - <em>and</em> to determine draws by threefold repetition. </p>
<p>It is guaranteed that the stack always contains at least one element in order to represent the game state on the current ply, and in addition the board will always attempt to keep a least three valid state entries in the stack in order to determine draws by threefold repetition. </p>

</div>
</div>
<hr/>The documentation for this struct was generated from the following file:<ul>
<li>/home/runner/work/max/max/include/max/board/<a class="el" href="board_8h_source.html">board.h</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="structmax__board__t.html">max_board_t</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.11.0 </li>
  </ul>
</div>
</body>
</html>
